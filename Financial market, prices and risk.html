<!DOCTYPE html>
<!-- saved from url=(0014)about:internet -->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>1 金融市场，价格和风险</title>

<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 12px;
   margin: 8px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 { 
   font-size:2.2em; 
}

h2 { 
   font-size:1.8em; 
}

h3 { 
   font-size:1.4em; 
}

h4 { 
   font-size:1.0em; 
}

h5 { 
   font-size:0.9em; 
}

h6 { 
   font-size:0.8em; 
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre {	
   margin-top: 0;
   max-width: 95%;
   border: 1px solid #ccc;
   white-space: pre-wrap;
}

pre code {
   display: block; padding: 0.5em;
}

code.r, code.cpp {
   background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * { 
      background: transparent !important; 
      color: black !important; 
      filter:none !important; 
      -ms-filter: none !important; 
   }

   body { 
      font-size:12pt; 
      max-width:100%; 
   }
       
   a, a:visited { 
      text-decoration: underline; 
   }

   hr { 
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote { 
      padding-right: 1em; 
      page-break-inside: avoid; 
   }

   tr, img { 
      page-break-inside: avoid; 
   }

   img { 
      max-width: 100% !important; 
   }

   @page :left { 
      margin: 15mm 20mm 15mm 10mm; 
   }
     
   @page :right { 
      margin: 15mm 10mm 15mm 20mm; 
   }

   p, h2, h3 { 
      orphans: 3; widows: 3; 
   }

   h2, h3 { 
      page-break-after: avoid; 
   }
}

</style>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: rgb(88, 72, 246)
   }

   pre .number {
     color: rgb(0, 0, 205);
   }

   pre .comment {
     color: rgb(76, 136, 107);
   }

   pre .keyword {
     color: rgb(0, 0, 255);
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: rgb(3, 106, 7);
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>


<!-- MathJax scripts -->
<script type="text/javascript" src="https://c328740.ssl.cf1.rackcdn.com/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



</head>

<body>
<h1>1 金融市场，价格和风险</h1>

<h2>1.1 价格，回报率和股票指数</h2>

<h3>1.1.1 股票指数</h3>

<h4>价格权重指数</h4>

<p>价格权重指数是根据价格来定义各个股票的权重，价格高则权重高，但这个方法并不能真正反映基础市场的价值</p>

<h4>价值权重指数</h4>

<p>价值权重指数是根据整个市场已发行股票的价值来定义权重的</p>

<h3>1.1.2 价格和收益</h3>

<p>\(  p_t=\frac{p_t-p_{t-1}}{p_{t-1}} \)</p>

<h2>1.2 S&amp;P500 回报率</h2>

<pre><code class="r">library(&quot;tseries&quot;)  # load the tseries library
library(&quot;zoo&quot;)
</code></pre>

<pre><code>## Attaching package: &#39;zoo&#39;
</code></pre>

<pre><code>## The following object is masked from &#39;package:base&#39;:
## 
## as.Date, as.Date.numeric
</code></pre>

<pre><code class="r">price = get.hist.quote(instrument = &quot;^gspc&quot;, start = &quot;2000-01-01&quot;, quote = &quot;AdjClose&quot;)  # download the prices,from January 1, 2000 until today
</code></pre>

<pre><code>## time series starts 2000-01-03
## time series ends   2013-04-26
</code></pre>

<pre><code class="r">y = diff(log(price))  # convert the prices into returns
plot(y)  # plot the returns
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-1"/> </p>

<pre><code class="r">y = coredata(y)  # strip date information from returns
library(&quot;moments&quot;)
</code></pre>

<pre><code>## Error: there is no package called &#39;moments&#39;
</code></pre>

<pre><code class="r">sd(y)
</code></pre>

<pre><code>## [1] 0.01339
</code></pre>

<pre><code class="r">min(y)
</code></pre>

<pre><code>## [1] -0.0947
</code></pre>

<pre><code class="r">max(y)
</code></pre>

<pre><code>## [1] 0.1096
</code></pre>

<pre><code class="r">skewness(y)
</code></pre>

<pre><code>## Error: could not find function &quot;skewness&quot;
</code></pre>

<pre><code class="r">kurtosis(y)
</code></pre>

<pre><code>## Error: could not find function &quot;kurtosis&quot;
</code></pre>

<pre><code class="r">acf(y, 1)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAAgVBMVEX9/v0AAAAAADkAAGUAAP8AOTkAOWUAOY8AZo8AZrU5AAA5ADk5AGU5OWU5OY85j485j9plAABlADllAGVlOQBlOTllOY9lZmVltbVltf2POQCPOTmPZgCPtY+P29qP2/21ZgC124+1/v3ajzna24/a/v39tWX924/9/rX9/tr9/v1JTQF2AAAAK3RSTlP///////////////////////////////////////////////////////8AI8mn0AAAAAlwSFlzAAALEgAACxIB0t1+/AAACgRJREFUeJzt3Yua2kQAQGGzVSvUC7TeoCq4sdze/wHNJFx3WZs4s2WGc/7vU7C1I+xhkiEuO1/thPTVrR+AbsPwUIaHMjyU4aEMD2V4KMNDGR7K8FCGhzI8lOGhDA9leCjDQxkeyvBQhocyPBQr/HZejQ73N9O3nzbTN4/hXlVVk3Ab/gmCFX49ro5tQ/j2zqpqjQx/v+rqt2q2a2d+9ft+xjf3J+F3HhZd+Lqb/uFF0r1Kwi/MbvzA00OF387f/D0edd0bXfj1OMz87XzWzfjlcfp3/8r+Fya3fuypocKvx6Om/WNz2/yt3odfHaN2L4OHRXPnYdG9HsKfaW7bP3VfUOHr5pAd/lqFJd5hcXcZvv2t8C+1M77JvV8BNC+H+0IKvz/Cjy7DXx7qj+Hbc3zT2/Dla1OGaXxxqG+m9tni7niob//EspodDvn3hhS+bg/qTcyLxd2Tt3OHxV33Kjn+wt3VB4Vvcod3ZXVTNZT/6YULOOdv59qJv7zH7qTwV6Au2VxCh6/vcSr3hA6/vMdLcj2hw5MZHsrwUIaHMjyU4aEMD2V4KMNDGR7K8FCGhzI8lOGhDA9leCjDQxkeyvBQhocyPJThoQwPZXgow0PFhK+Us1cMH/Fn9doMD2V4KMNDGR4qOvzxRwYNHVo3FRs+/BywYPX8Z0cYPmex4TcfHi9u+w+tm3LGQ0Wf47uf5us5vjSu6qEMD5Uq/Nni7oX/DeDrICtfbsYbPiuGhzI8lOGhoq/cTfcruedv5A2fs+gZv52/tAOT4XMWf6jfvH9hPxbD58xzPJThoQwPZXgow0MZHsrwUIaHMjyU4aEMD2V4KMNDGR7K8FCGhzI8lOGhDA9leCjDQxkeyvBQhocyPJThoQwPZXgow0MZHsrwUIaHMjyU4aEMD2V4KMNDGR7K8FCGhzI8lOGhDA9leCjDQxkeyvBQhocyPFR0+PW4GtV99pY1fFZiw28/Lnb1qOn/4+d2kzZ8VmLDh61F60mf/eMNnxVnPFSKc/zEc3x5XNVDGR4qVXj3jy+MMx7K8FApVvXXN5M2fNai38fPZ+3t6q3v44uS4srd+e3LQxs+K854qOhz/GbqOb5EruqhDA9leCjDQxkeyvBQhocyPJThoQwPZXgow0MZHsrwUIaHMjyU4aEMD2V4KMNDGR7K8FCGhzI8lOGhDA9leCjDQxkeyvBQhocyPJThoQwPZXgow0MZHsrwUIaHMjyU4aEMD2V4KMNDGR7K8FCGhzI8VHT49Xi2nVfV8w0qDJ+12PBha5LlzE2FixMbfvPhMWwo7WZEpYk+1DfTfTXZ7Vajzw1t+KzEL+6W7WZEz7sbPmuu6qEMD5UqvNuIF8YZD2V4qARX7txitEQprtwFbipcmARX7i5uXx7a8FlxxkNFn+PdRrxMruqhDA9leCjDQxkeyvBQhocyPJThoQwPZXgow0MZHsrwUIaHMjyU4aEMD2V4KMNDGR7K8FCGhzI8lOGhDA/VI/yVz0P+n6ENn5We4a/8/MKhQxs+K4aHMjxUn/DT/U+xuvJR6AFDGz4rruqhDA/VK/xyFA74s7ihDZ+VPuHr9ufbbKaTqKENn5U+i7v3i/b+0JW94XM24Mrd0Ct4hs9Zj/D/8RPNhgxt+Kz0Ocev34Vj/Xo8cHVn+Jz1WtW3l3AGXr4xfN58Hw9leKj+4Wuv1d+TnuFXVfWwiBva8FnptaofN9WXQ6/YGj5rvS/gGP6+9Jnx4d3czPD3pe/ibuk5/r70X9Vv567q70ia9/Hr76+8Jgyfs9jw//ENeYbPWfSM30yb5M744iQ41G+mb/8xfGmSnOPX42vrPsPnzP9JA2V4qFTh3T++MM54KMNDRYd3//gyxYZ3N+lCRV+ydf/4MjnjoRJcq/ccXyJX9VCGhzI8lOGhDA9leCjDQxkeyvBQhocyPJThoQwPZXgow0MZHsrwUIaHMjyU4aEMD2V4KMNDGR7K8FCGhzI8lOGhDA9leCjDQxkeyvBQhocyPJThoQwPZXgow0MZHsrwUIaHMjyU4aEMD2V4KMNDGR4qOvx6XD0s3JqkOLHhw9Yk2/nE8KWJDd8FX44MX5gUM75Rf/N8I3HD5yz6HL+ZTsJN/Xw3IsPnzFU9lOGhUoV3G/HCOOOhDA+V4sqdW4wWKNH7eDcVLk2aK3deqy+OMx4qwZU7z/ElclUPZXgow0MZHsrwUIaHMjyU4aEMD2V4KMNDGR7K8FCGhzI8lOGhDA9leCjDQxkeyvBQhocyPJThoQwPZXgow0MZHsrwUIaHMjyU4aEMD2V4KMNDGR7K8FCGhzI8lOGhDA9leCjDQxkeyvBQrxj+6+B0Wz35Z29veuuMhzI8VHR4NyMqU2x4tyYpVGx4NyMqlDMeKvoc72ZEZXJVD2V4qFThr20jrpwlCn+FUzwrww7Ahr8bqcP3vnKn20ocvv/7eN1W4vD9r9zptpzxUKnP8b2v3Om2XNVDGR7K8FBfLnwe31To7f72yTe7OuMpPNRDGR7K8FCGhzI8lOGhDA9leCjDQxkeyvBQhocyPJThoQwPZXgFhocyPJThoQwPZXgow0MZHsrwUIaHMjyU4aEMD/Wa4ZWz1wv/9HWQbqi0g2X7wG45mOGhgxkeOpjhoYMZHjqY4aGDGR46WMLwKonhoQwPZXgow0MZHsrwUIaHMjyU4aEShN9Mq/1GRad7CQYL+93NEo112lMpwWDbefWwSDVY8yyv7PYz0Pr7xyfDfl58+PAlrUeX9xIMtnm/2K3fxXyBLx5OHfkiOhtsObu2Jdf/Gyw8yzp2sqz2r51BX//48GFDuu4ld7qXYLBVeAbLmFrnD2f9w8+RR4+LZxnpNNj6x0/RAy4f/uye5aCvf3z49rG/X1zcSzBYEDfY2Vjbj39FHurPn+UfsYf602BJZvyh9qCvf3z4cNjr/nOnewkG24VD1yTRWPUk9hx/Gmw9nrVf4jSPLMGy6Bh+0Nc/4xm/mUZ1v3xgseFf6VmGVcwqenV3mxn/Suf4dmYlemB1+33mUS+js2f5a3T4s5VM/EFydwz/hc/x4YB8WNVP4lf1hyGiu18+nNgZfzbYMvpQf/YsU874QV//ZO/jw3882fv4ZrBulkbVOj2wZO/j988yNtVpsFUVfVGgCz/06++VOyjDQxkeyvBQhocyPJThoQwPZXgow0MZHsrwUIaHMjyU4aEMD2V4KMNDGR7K8FD08JHfDl4uwxse6fipyu5D2Ztp9e0v0d/uXALDdx9CCR/Kbu4uJ7tV/Pe5l8Dwx0P95sNj+BDS9qPhAY7hl1X15jF8NMrwCIdD/XQW7jrjMQ4fzQ2fPnu38ByPEVbzVTUKn6T+9udZWNV/54xngryzN/y57TzFp5aLYHgow0MZHsrwUIaHMjyU4aEMD2V4KMNDGR7K8FCGhzI8lOGhDA/1L6Pdgl14bteCAAAAAElFTkSuQmCC" alt="plot of chunk unnamed-chunk-1"/> </p>

<pre><code class="r">acf(y^2, 1)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAAgVBMVEX9/v0AAAAAADkAAGUAAP8AOTkAOWUAOY8AZo8AZrU5AAA5ADk5AGU5OWU5OY85j485j9plAABlADllAGVlOQBlOTllOY9lZmVltbVltf2POQCPOTmPZgCPtY+P29qP2/21ZgC124+1/v3ajzna24/a/v39tWX924/9/rX9/tr9/v1JTQF2AAAAK3RSTlP///////////////////////////////////////////////////////8AI8mn0AAAAAlwSFlzAAALEgAACxIB0t1+/AAAChxJREFUeJzt3Qt32kYCQOHK2W0KSVtIug9Id6FWg4D//wOrkXgIGydSZ4xH3Pud00IeHgOXkQbFoB/2QvrhrW+A3obhoQwPZXgow0MZHsrwUIaHMjyU4aEMD2V4KMNDGR7K8FCGhzI8lOGhDA9leChW+N2ymByvb+fvv27n7x7DtaIoZuEy/AqCFb6aFqe2IXxzZVM0Joa/X2Xxn2Kxb2Z+8d/DjK+vz8KfPKza8GU7/cOTpH2WhN9YvPENTw8Vfrd898d00navteGraZj5u+WinfHr0/Rv/8rhN2ZvfdtTQ4WvppO6/WN9Wf+vPITfnKK2T4OHVX3lYdU+H8LX1JfNV90XVPiy3mSH/zZhiXdc3F2Gb/4o/KVmxte5DyuA+ulwX0jhD1v4yWX4y039KXyzj697G378mpRhGl9s6uup3VncnTb1zVesi8Vxk39vSOHLZqNex7xY3D15OXdc3LXPktNv3F19UPg6d3hVVtZVQ/lfXziA030510z89T12J4W/AnXI5hI6fHmPU7kndPj1PR6S6wkdnszwUIaHMjyU4aEMD2V4KMNDGR7K8FCGhzI8lOGhDA9leCjDQxkeyvBQhocyPJThoQwPZXgow0MZHiomfKGcvWL4iK/VazM8lOGhDA9leKjo8KePDBo6tN5UbPjwOWDB5vlnRxg+Z7Hht58fLy77D6035YyHit7Ht5/m6z5+bFzVQxkeKlX4zuLuhX8G8HmQldvNeMNnxfBQhocyPFT0kbv5YSX3/IW84XMWPeN3y5fOwGT4nMVv6refXjgfi+Fz5j4eyvBQhocyPJThoQwPZXgow0MZHsrwUIaHMjyU4aEMD2V4KMNDGR7K8FCGhzI8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" alt="plot of chunk unnamed-chunk-1"/> </p>

<pre><code class="r">jarque.bera.test(y)
</code></pre>

<pre><code>## 
##  Jarque Bera Test
## 
## data:  y
## X-squared = 7741, df = 2, p-value &lt; 2.2e-16
</code></pre>

<pre><code class="r">Box.test(y, lag = 20, type = c(&quot;Ljung-Box&quot;))
</code></pre>

<pre><code>## 
##  Box-Ljung test
## 
## data:  y
## X-squared = 102.9, df = 20, p-value = 3.844e-13
</code></pre>

<pre><code class="r">Box.test(y^2, lag = 20, type = c(&quot;Ljung-Box&quot;))
</code></pre>

<pre><code>## 
##  Box-Ljung test
## 
## data:  y^2
## X-squared = 4627, df = 20, p-value &lt; 2.2e-16
</code></pre>

<h2>1.3 回报率的程式化因子</h2>

<ul>
<li>波动集群</li>
<li>后尾</li>
<li>非线性相关</li>
</ul>

<h2>1.4 波动率</h2>

<p>收益率的标准偏差称为波动率</p>

<pre><code class="r">library(MASS, stats)  # load stats and MASS package
q = acf(y, 20)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAAeFBMVEX9/v0AAAAAADkAAGUAAP8AOTkAOWUAOY8AZo8AZrU5AAA5ADk5AGU5OY85j485j9plAABlADllAGVlOQBlOTllZmVltbVltf2POQCPOTmPOWWPtY+P2/21ZgC124+1/v3ajzna24/a/v39tWX924/9/rX9/tr9/v3HOthfAAAAKHRSTlP///////////////////////////////////////////////////8AvqouGAAAAAlwSFlzAAALEgAACxIB0t1+/AAACidJREFUeJzt3Qt32kYCQOHK3W0W+oCkD+gu1LS8/v8/XI0wrolxLXlmYEb33nNanMQMIh+DhGKYb46G7Jt7b4DdJ+GhCQ9NeGjCQxMemvDQhIcmPDThoQkPTXhowkMTHprw0ISHJjw04aEJD014aCz4w7KZnL/ezz/9tZ9/+xi+appmFi7DryCx4HfT5tk2wHdfbJuuifDjbdP82iyO3cxvfnua8e3Xs/AnD6sT/OY0/cOD5PQoCb+xuPOGpw8Ff1h++8d0cnJvO8HvpmHmH5aL04xfP0//07c8/cbs3tueOhT8bjpp7R/by/Z/myf47TPq6WHwsGq/eFidHg/hOu1ld61xhYLftE/Z4b9tOMQ7H9xdwnd/FL6pm/Et99MRQPtwGFck+Kdn+Mkl/OVT/TN8t49vvYWvv44yTOOLp/p2ar84uHt+qu+usW4W56f8sUWC33RP6i3mxcHdVy/nzgd3p0fJ82+MTh8E33KHV2WbVjXI//TGCZyXL+e6ib8eozsJ/kqoUzaXoeE3Y5zKPUPDr8d4Sq5naHhywkMTHprw0ISHJjw04aEJD014aMJDEx6a8NCEhyY8NOGhCQ9NeGjCQxMemvDQhIcmPDThoQkPTXhoMfCNlVxG+IjrWu6EhyY8NOGhCQ8tGv75I4OGDm13LRY+fA5YaPv6syOEL7lY+P2Xx4vL/kPbXXPGQ4vex58+zdd9fG15VA9NeGip4F8c3L3xzwA+DorqdjNe+KISHprw0ISHFn3mbv50JPf6hbzwJRc94w/Lt1ZgEr7k4p/q95/fWI9F+JJzHw9NeGjCQxMemvDQhIcmPDThoQkPTXhowkMTHprw0ISHJjw04aEJD014aMJDEx6a8NCEhyY8NOGh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" alt="plot of chunk unnamed-chunk-2"/> </p>

<pre><code class="r">plot(q[2:20])
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAAeFBMVEX9/v0AAAAAADkAAGUAAP8AOTkAOWUAOY8AZo8AZrU5AAA5ADk5AGU5OY85j485j9plAABlADllAGVlOQBlOTllZmVltbVltf2POQCPOTmPOWWPtY+P2/21ZgC124+1/v3ajzna24/a/v39tWX924/9/rX9/tr9/v3HOthfAAAAKHRSTlP///////////////////////////////////////////////////8AvqouGAAAAAlwSFlzAAALEgAACxIB0t1+/AAADWxJREFUeJztnQ174jYWRkv6MUs6s6SzH6S7YUMLgf//D9cykE4mJujKV7Kl95znaclMr94b90Qg+4nlH44gyQ9TfwMwDYgXBfGiIF4UxIuCeFEQLwriRUG8KIgXBfGiIF4UxIuCeFEQLwriRUG8KIgXBfGiIF4ULfGHx8Xy8vXLw6c/Xx5+fA5fLRaLVXgNfxJBS/z+fvHqNojvv9gtepaIb5ft4l+L9bGf+Yt/n2d89/Uq/Je7p5P47Wn6hx+S009J+Iv1xN+4P1LiD48//u9+efLecRK/vw8z//C4Ps34zev0P5Wc/2I19ffujZT4/f2yc//cvXb/2p7F716lnn4M7p66L+6eTj8PYUz32o9qCynx2+4tO/yzC0u8y+Lurfj+P4WifsZ3us8rgO7HoS2UxJ/f4Zdvxb99q38V33/Gd74RXz+9yjCN37zVd1P7m8Xd61t9P2KzWF/e8ltDSfy2f1PvZL5Z3H13OndZ3J1+Sl7/ojn7QuI73eGsbNtZDeb/fuUCzrenc/3E37ToXUn8AFKXbN4iLX7b4lSORFr8psVLcpFIi1cG8aIgXhTEi4J4URAvCuJFQbwoiBcF8aIgXhTEi4J4URAvCuJFQbwoiBcF8aIgXhTEi4J4URAvCuJFQbwoiBdljPgFzJmM4keMhdwgXhTEi4J4URAvCuJFQbwoiBcF8aIgXhTEi4J4URA/Q0r8n0P8DEG8KIgXBfGiIF4UxIuCeFEQLwriRUG8KIgXpQrx+/v+cV0DD29BfCo1iA+PYNysO/9f3plHfCo1iH/5+nz4/al/NUbDVWoQH6b7bnU87pbWaLhKFeJfH7ppjYar1CE+NRqugnhRqhD/+vBtazRcpQbx4XQusHt/Io/4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" alt="plot of chunk unnamed-chunk-2"/> </p>

<pre><code class="r">q = acf(y^2, 20)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-2"/> </p>

<pre><code class="r">plot(q[2:20])
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAAdVBMVEX9/v0AAAAAADkAAGUAAP8AOTkAOWUAOY8AZo8AZrU5AAA5ADk5AGU5OY85j485j9plAABlADllAGVlOQBlOTllZmVltbVltf2POQCPOTmPOWWPtY+P2/21ZgC124+1/v3ajzna/v39tWX924/9/rX9/tr9/v1rbiYTAAAAJ3RSTlP//////////////////////////////////////////////////wCDVpfZAAAACXBIWXMAAAsSAAALEgHS3X78AAAMO0lEQVR4nO2di3baSBZFW/ZMu013BnfmATNjxpjX/3/iqATYRrGjeqhKdXX2XiuBKPfoltiUXgnmlxNI8svUA4BpQLwoiBcF8aIgXhTEi4J4URAvCuJFQbwoiBcF8aIgXhTEi4J4URAvCuJFQbwoiBcF8aJoiT+um8fr88PTw+vh6f7FPWuaZuke3Z9E0BK/XzRvbp347smu6XhE/HzZNv9sVqdu5jf/usz49vnS/c3d81n89jz93Zvk/C5xC1YTD3x8pMQf1/f/Wzyevbecxe8XbuYf16vzjN+8Tf9zyWXBcuqxj42U+P3isXX/0j62v20v4ndvUs9vg7vn9snd8/n94DLtY5eaF1Lit+0u2/3auVO868ndrfjur1xRN+Nb3ZczgPbtMC+UxF/28I+34m939W/iu2N86xvx9ulUuml8s6tvp/aHk7u3XX2X2DSr6y5/biiJ33Y79Vbmzcld73LuenJ3fpe8LZidfSHxrW53VbZtrTrzf/viBs7Hy7lu4m/m6F1J/CdI3bK5RVr8do5T2RNp8Zs53pLzRFq8MogXBfGiIF4UxIuCeFEQLwriRUG8KIgXBfGiIF4UxIuCeFEQLwriRUG8KIgXBfGiIF4UxIuCeFEQLwriRUG8KCniG6iZjOITspAbxIuCeFEQLwriRUG8KIgXBfGiIF4UxIuCeFEQL0o58bwPqgLxoiBeFMSLgnhREC8K4kVBvCiIFwXxoiBeFMSLgnhfrI+/B+J9sT7+Hoj3xfr4eyDeF+vj74F4X6yPvwfifbE+/h6I98X6+Hsg3hfr4++BeF+sj78H4n2xPv4eiPfF+vh7IN4X6+PvgXhfrI+/B+J9sT7+Hoj3xfr4eyDeF+vj74F4X6yPvwfifbE+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" alt="plot of chunk unnamed-chunk-2"/> </p>

<pre><code class="r">b = Box.test(y, lag = 21, type = &quot;Ljung-Box&quot;)
b
</code></pre>

<pre><code>## 
##  Box-Ljung test
## 
## data:  y
## X-squared = 110.9, df = 21, p-value = 3.209e-14
</code></pre>

<h2>1.6 后尾的定义</h2>

<h3>1.6.1 后尾的检验</h3>

<p>相比于同方差同均值的正态分布而言，具有更多极端值的分布称之为后尾分布</p>

<h1>2单变量的波动模型</h1>

<p>本章主要讲述了单边量的波动模型，包括ARCH模型，GARCH模型，</p>

<p>Listing 2.1 Garch and estmation in R</p>

<pre><code class="r">library(tseries)
library(zoo)
p = get.hist.quote(instrument = &quot;^gspc&quot;, start = &quot;2005-01-01&quot;, end = &quot;2009-12-31&quot;, 
    quote = &quot;AdjClose&quot;, quiet = T)  # download the prices
y = diff(log(p)) * 100  # get returns and multiply them by 100 (so they are expressed in returns)
y = y - mean(y)  # de-mean (set mean to zero)
library(fGarch)
</code></pre>

<pre><code>## Loading required package: timeDate
</code></pre>

<pre><code>## Loading required package: timeSeries
</code></pre>

<pre><code>## Attaching package: &#39;timeSeries&#39;
</code></pre>

<pre><code>## The following object is masked from &#39;package:zoo&#39;:
## 
## time&lt;-
</code></pre>

<pre><code>## Loading required package: fBasics
</code></pre>

<pre><code>## Attaching package: &#39;fBasics&#39;
</code></pre>

<pre><code>## The following object is masked from &#39;package:base&#39;:
## 
## norm
</code></pre>

<pre><code class="r">garchFit(~garch(1, 0), data = y, include.mean = FALSE)
</code></pre>

<pre><code>## 
## Series Initialization:
##  ARMA Model:                arma
##  Formula Mean:              ~ arma(0, 0)
##  GARCH Model:               garch
##  Formula Variance:          ~ garch(1, 0)
##  ARMA Order:                0 0
##  Max ARMA Order:            0
##  GARCH Order:               1 0
##  Max GARCH Order:           1
##  Maximum Order:             1
##  Conditional Dist:          norm
##  h.start:                   2
##  llh.start:                 1
##  Length of Series:          1258
##  Recursion Init:            mci
##  Series Scale:              1.517
## 
## Parameter Initialization:
##  Initial Parameters:          $params
##  Limits of Transformations:   $U, $V
##  Which Parameters are Fixed?  $includes
##  Parameter Matrix:
##                     U         V params includes
##     mu     -2.045e-16 2.045e-16    0.0    FALSE
##     omega   1.000e-06 1.000e+02    0.1     TRUE
##     alpha1  1.000e-08 1.000e+00    0.1     TRUE
##     gamma1 -1.000e+00 1.000e+00    0.1    FALSE
##     delta   0.000e+00 2.000e+00    2.0    FALSE
##     skew    1.000e-01 1.000e+01    1.0    FALSE
##     shape   1.000e+00 1.000e+01    4.0    FALSE
##  Index List of Parameters to be Optimized:
##  omega alpha1 
##      2      3 
##  Persistence:                  0.1 
## 
## 
## --- START OF TRACE ---
## Selected Algorithm: nlminb 
## 
## R coded nlminb Solver: 
## 
##   0:     3619.7535: 0.100000 0.100000
##   1:     1736.5493:  1.05877 0.384182
##   2:     1734.9231: 0.910957 0.861833
##   3:     1727.5654: 0.863579 0.885867
##   4:     1706.4504: 0.384832  1.00000
##   5:     1701.9170: 0.664453  1.00000
##   6:     1686.8002: 0.680349 0.500253
##   7:     1684.6694: 0.630763 0.457624
##   8:     1683.9466: 0.591071 0.552831
##   9:     1683.9427: 0.593749 0.554564
##  10:     1683.9425: 0.593205 0.554806
##  11:     1683.9425: 0.593178 0.554881
##  12:     1683.9425: 0.593177 0.554892
## 
## Final Estimate of the Negative LLH:
##  LLH:  2208    norm LLH:  1.755 
##  omega alpha1 
## 1.3655 0.5549 
## 
## R-optimhess Difference Approximated Hessian Matrix:
##         omega alpha1
## omega  -215.2 -114.4
## alpha1 -114.4 -176.8
## attr(,&quot;time&quot;)
## Time difference of 0.015 secs
## 
## --- END OF TRACE ---
## 
## 
## Time to Estimate Parameters:
##  Time difference of 0.197 secs
</code></pre>

<pre><code>## 
## Title:
##  GARCH Modelling 
## 
## Call:
##  garchFit(formula = ~garch(1, 0), data = y, include.mean = FALSE) 
## 
## Mean and Variance Equation:
##  data ~ garch(1, 0)
## &lt;environment: 0x06ccc184&gt;
##  [data = y]
## 
## Conditional Distribution:
##  norm 
## 
## Coefficient(s):
##   omega   alpha1  
## 1.36554  0.55489  
## 
## Std. Errors:
##  based on Hessian 
## 
## Error Analysis:
##         Estimate  Std. Error  t value Pr(&gt;|t|)    
## omega    1.36554     0.08417   16.224  &lt; 2e-16 ***
## alpha1   0.55489     0.09287    5.975  2.3e-09 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Log Likelihood:
##  -2208    normalized:  -1.755 
## 
## Description:
##  Sun Apr 28 20:41:10 2013 by user: Z-Q
</code></pre>

<pre><code class="r">garchFit(~garch(4, 0), data = y, include.mean = FALSE)
</code></pre>

<pre><code>## 
## Series Initialization:
##  ARMA Model:                arma
##  Formula Mean:              ~ arma(0, 0)
##  GARCH Model:               garch
##  Formula Variance:          ~ garch(4, 0)
##  ARMA Order:                0 0
##  Max ARMA Order:            0
##  GARCH Order:               4 0
##  Max GARCH Order:           4
##  Maximum Order:             4
##  Conditional Dist:          norm
##  h.start:                   5
##  llh.start:                 1
##  Length of Series:          1258
##  Recursion Init:            mci
##  Series Scale:              1.517
## 
## Parameter Initialization:
##  Initial Parameters:          $params
##  Limits of Transformations:   $U, $V
##  Which Parameters are Fixed?  $includes
##  Parameter Matrix:
##                     U         V params includes
##     mu     -2.045e-16 2.045e-16  0.000    FALSE
##     omega   1.000e-06 1.000e+02  0.100     TRUE
##     alpha1  1.000e-08 1.000e+00  0.025     TRUE
##     alpha2  1.000e-08 1.000e+00  0.025     TRUE
##     alpha3  1.000e-08 1.000e+00  0.025     TRUE
##     alpha4  1.000e-08 1.000e+00  0.025     TRUE
##     gamma1 -1.000e+00 1.000e+00  0.100    FALSE
##     gamma2 -1.000e+00 1.000e+00  0.100    FALSE
##     gamma3 -1.000e+00 1.000e+00  0.100    FALSE
##     gamma4 -1.000e+00 1.000e+00  0.100    FALSE
##     delta   0.000e+00 2.000e+00  2.000    FALSE
##     skew    1.000e-01 1.000e+01  1.000    FALSE
##     shape   1.000e+00 1.000e+01  4.000    FALSE
##  Index List of Parameters to be Optimized:
##  omega alpha1 alpha2 alpha3 alpha4 
##      2      3      4      5      6 
##  Persistence:                  0.1 
## 
## 
## --- START OF TRACE ---
## Selected Algorithm: nlminb 
## 
## R coded nlminb Solver: 
## 
##   0:     2409.5886: 0.100000 0.0250000 0.0250000 0.0250000 0.0250000
##   1:     1634.2681: 0.605504 0.341611 0.493258 0.452004 0.517571
##   2:     1508.9667: 0.177761 0.317173 0.644313 0.562588 0.694749
##   3:     1484.7888: 0.125350 0.297703 0.630150 0.548161 0.680585
##   4:     1483.0467: 0.0293856 0.249943 0.596677 0.514236 0.646238
##   5:     1460.6657: 0.0901598 0.245816 0.594548 0.511509 0.642660
##   6:     1419.9971: 0.0881340 0.237176 0.212690 0.270380 0.536730
##   7:     1412.6610: 0.141853 0.224502 0.219612 0.272670 0.529546
##   8:     1406.2625: 0.116981 0.175002 0.215501 0.270963 0.521647
##   9:     1399.1552: 0.164221 0.0770032 0.221573 0.293958 0.507377
##  10:     1397.1205: 0.111162 0.0815859 0.199592 0.397825 0.316824
##  11:     1391.5523: 0.151695 0.0487936 0.257950 0.367466 0.360498
##  12:     1390.8295: 0.121618 0.0484306 0.307081 0.295438 0.381622
##  13:     1390.4117: 0.142307 0.100555 0.325059 0.280405 0.309105
##  14:     1390.1985: 0.159271 0.0312684 0.276898 0.306367 0.338616
##  15:     1390.1285: 0.121470 0.0573769 0.274604 0.299863 0.329666
##  16:     1388.6310: 0.144747 0.0599697 0.277652 0.301165 0.329622
##  17:     1388.4076: 0.142632 0.0522377 0.277043 0.304677 0.307654
##  18:     1388.2748: 0.143882 0.0564945 0.288840 0.284835 0.310300
##  19:     1388.2715: 0.141054 0.0600232 0.288784 0.285109 0.300287
##  20:     1388.2571: 0.146141 0.0599910 0.290309 0.286269 0.299476
##  21:     1388.2365: 0.143608 0.0588209 0.293842 0.287907 0.296783
##  22:     1388.2352: 0.143808 0.0579819 0.293315 0.287230 0.296642
##  23:     1388.2344: 0.144044 0.0584477 0.292403 0.286684 0.296954
##  24:     1388.2344: 0.143977 0.0583760 0.292362 0.286571 0.296953
##  25:     1388.2344: 0.144066 0.0583770 0.292352 0.286486 0.297046
##  26:     1388.2343: 0.144027 0.0583796 0.292265 0.286326 0.297294
##  27:     1388.2343: 0.144115 0.0583935 0.292171 0.286096 0.297131
##  28:     1388.2343: 0.144081 0.0584085 0.292230 0.285995 0.297129
##  29:     1388.2343: 0.144095 0.0584235 0.292184 0.286010 0.297173
##  30:     1388.2343: 0.144096 0.0584091 0.292194 0.286010 0.297172
##  31:     1388.2343: 0.144095 0.0584118 0.292200 0.286014 0.297162
## 
## Final Estimate of the Negative LLH:
##  LLH:  1913    norm LLH:  1.52 
##   omega  alpha1  alpha2  alpha3  alpha4 
## 0.33172 0.05841 0.29220 0.28601 0.29716 
## 
## R-optimhess Difference Approximated Hessian Matrix:
##          omega  alpha1 alpha2 alpha3 alpha4
## omega  -1256.4  -440.4 -324.6 -348.6 -287.6
## alpha1  -440.4 -2405.5 -257.9 -360.9 -324.8
## alpha2  -324.6  -257.9 -591.2 -156.3 -222.9
## alpha3  -348.6  -360.9 -156.3 -652.8 -156.2
## alpha4  -287.6  -324.8 -222.9 -156.2 -592.5
## attr(,&quot;time&quot;)
## Time difference of 0.147 secs
## 
## --- END OF TRACE ---
## 
## 
## Time to Estimate Parameters:
##  Time difference of 0.541 secs
</code></pre>

<pre><code>## 
## Title:
##  GARCH Modelling 
## 
## Call:
##  garchFit(formula = ~garch(4, 0), data = y, include.mean = FALSE) 
## 
## Mean and Variance Equation:
##  data ~ garch(4, 0)
## &lt;environment: 0x072f01e8&gt;
##  [data = y]
## 
## Conditional Distribution:
##  norm 
## 
## Coefficient(s):
##    omega    alpha1    alpha2    alpha3    alpha4  
## 0.331720  0.058412  0.292200  0.286014  0.297162  
## 
## Std. Errors:
##  based on Hessian 
## 
## Error Analysis:
##         Estimate  Std. Error  t value Pr(&gt;|t|)    
## omega    0.33172     0.03285   10.097  &lt; 2e-16 ***
## alpha1   0.05841     0.02198    2.657  0.00789 ** 
## alpha2   0.29220     0.04664    6.266 3.71e-10 ***
## alpha3   0.28601     0.04376    6.536 6.30e-11 ***
## alpha4   0.29716     0.04636    6.410 1.46e-10 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Log Likelihood:
##  -1913    normalized:  -1.52 
## 
## Description:
##  Sun Apr 28 20:41:11 2013 by user: Z-Q
</code></pre>

<pre><code class="r">garchFit(~garch(4, 1), data = y, include.mean = FALSE)
</code></pre>

<pre><code>## 
## Series Initialization:
##  ARMA Model:                arma
##  Formula Mean:              ~ arma(0, 0)
##  GARCH Model:               garch
##  Formula Variance:          ~ garch(4, 1)
##  ARMA Order:                0 0
##  Max ARMA Order:            0
##  GARCH Order:               4 1
##  Max GARCH Order:           4
##  Maximum Order:             4
##  Conditional Dist:          norm
##  h.start:                   5
##  llh.start:                 1
##  Length of Series:          1258
##  Recursion Init:            mci
##  Series Scale:              1.517
## 
## Parameter Initialization:
##  Initial Parameters:          $params
##  Limits of Transformations:   $U, $V
##  Which Parameters are Fixed?  $includes
##  Parameter Matrix:
##                     U         V params includes
##     mu     -2.045e-16 2.045e-16  0.000    FALSE
##     omega   1.000e-06 1.000e+02  0.100     TRUE
##     alpha1  1.000e-08 1.000e+00  0.025     TRUE
##     alpha2  1.000e-08 1.000e+00  0.025     TRUE
##     alpha3  1.000e-08 1.000e+00  0.025     TRUE
##     alpha4  1.000e-08 1.000e+00  0.025     TRUE
##     gamma1 -1.000e+00 1.000e+00  0.100    FALSE
##     gamma2 -1.000e+00 1.000e+00  0.100    FALSE
##     gamma3 -1.000e+00 1.000e+00  0.100    FALSE
##     gamma4 -1.000e+00 1.000e+00  0.100    FALSE
##     beta1   1.000e-08 1.000e+00  0.800     TRUE
##     delta   0.000e+00 2.000e+00  2.000    FALSE
##     skew    1.000e-01 1.000e+01  1.000    FALSE
##     shape   1.000e+00 1.000e+01  4.000    FALSE
##  Index List of Parameters to be Optimized:
##  omega alpha1 alpha2 alpha3 alpha4  beta1 
##      2      3      4      5      6     11 
##  Persistence:                  0.9 
## 
## 
## --- START OF TRACE ---
## Selected Algorithm: nlminb 
## 
## R coded nlminb Solver: 
## 
##   0:     1454.0447: 0.100000 0.0250000 0.0250000 0.0250000 0.0250000 0.800000
##   1:     1421.1372: 0.0859711 0.0243535 0.0248923 0.0249677 0.0252496 0.792899
##   2:     1363.8284: 0.0568752 0.0254567 0.0274169 0.0277607 0.0287641 0.782100
##   3:     1361.7406: 1.00000e-06 0.0535091 0.0686093 0.0724666 0.0790831 0.744097
##   4:     1326.5003: 0.0262444 0.0545103 0.0698955 0.0739075 0.0808466 0.746825
##   5:     1306.3077: 0.0171893 1.00000e-08 0.0295200 0.0475685 0.0596863 0.814206
##   6:     1303.6136: 0.0155295 1.00000e-08 0.0334227 0.0646853 0.0870203 0.802417
##   7:     1302.8752: 0.0124800 1.00000e-08 0.0325557 0.0638882 0.0862444 0.801591
##   8:     1302.5268: 0.0137285 1.00000e-08 0.0304067 0.0631009 0.0859054 0.803840
##   9:     1302.2210: 0.0131067 1.00000e-08 0.0257736 0.0610495 0.0844557 0.808281
##  10:     1302.1166: 0.0142083 1.00000e-08 0.0246580 0.0605445 0.0801468 0.813439
##  11:     1301.9123: 0.0130200 1.00000e-08 0.0233028 0.0607878 0.0750261 0.817723
##  12:     1301.8691: 0.0132720 1.00000e-08 0.0197157 0.0596741 0.0808318 0.817645
##  13:     1301.8157: 0.0127305 1.00000e-08 0.0285859 0.0524468 0.0746367 0.822330
##  14:     1301.7625: 0.0107783 1.00000e-08 0.0259073 0.0627508 0.0684135 0.828300
##  15:     1301.7211: 0.0113005 1.00000e-08 0.0258069 0.0626756 0.0683645 0.828357
##  16:     1301.6968: 0.0111292 1.00000e-08 0.0254756 0.0623912 0.0681249 0.828228
##  17:     1301.6697: 0.0115587 1.00000e-08 0.0249348 0.0618267 0.0687064 0.828434
##  18:     1301.6345: 0.0112946 1.00000e-08 0.0239627 0.0605500 0.0701205 0.828677
##  19:     1301.5690: 0.0115151 1.00000e-08 0.0207939 0.0594502 0.0719591 0.830710
##  20:     1301.5548: 0.0111579 1.00000e-08 0.0200001 0.0619979 0.0687002 0.831683
##  21:     1301.5405: 0.0112880 1.00000e-08 0.0192838 0.0642931 0.0655428 0.833429
##  22:     1301.5093: 0.0109835 1.00000e-08 0.0195059 0.0576699 0.0715898 0.834873
##  23:     1301.5062: 0.0108777 1.00000e-08 0.0194466 0.0576190 0.0715383 0.834848
##  24:     1301.5046: 0.0109821 1.00000e-08 0.0193820 0.0575710 0.0714900 0.834878
##  25:     1301.5016: 0.0108989 1.00000e-08 0.0192794 0.0575799 0.0713067 0.835054
##  26:     1301.4753: 0.0105717 1.00000e-08 0.0183692 0.0585168 0.0681855 0.838863
##  27:     1301.4751: 0.0106026 1.00000e-08 0.0138868 0.0587259 0.0700663 0.840407
##  28:     1301.4640: 0.0102893 1.00000e-08 0.0169715 0.0569871 0.0665746 0.842948
##  29:     1301.4630: 0.0103454 1.00000e-08 0.0176236 0.0572678 0.0667403 0.842040
##  30:     1301.4629: 0.0103324 1.00000e-08 0.0174860 0.0572276 0.0667049 0.842216
##  31:     1301.4629: 0.0103331 1.00000e-08 0.0174900 0.0572204 0.0667014 0.842220
## 
## Final Estimate of the Negative LLH:
##  LLH:  1826    norm LLH:  1.451 
##     omega    alpha1    alpha2    alpha3    alpha4     beta1 
## 2.379e-02 1.000e-08 1.749e-02 5.722e-02 6.670e-02 8.422e-01 
## 
## R-optimhess Difference Approximated Hessian Matrix:
##         omega alpha1 alpha2 alpha3 alpha4  beta1
## omega  -79440 -25971 -25061 -25037 -25579 -39015
## alpha1 -25971 -24164 -21673 -20632 -20287 -23003
## alpha2 -25061 -21673 -22052 -20738 -20482 -23098
## alpha3 -25037 -20632 -20738 -20672 -20079 -22858
## alpha4 -25579 -20287 -20482 -20079 -20621 -23197
## beta1  -39015 -23003 -23098 -22858 -23197 -29762
## attr(,&quot;time&quot;)
## Time difference of 0.216 secs
## 
## --- END OF TRACE ---
## 
## 
## Time to Estimate Parameters:
##  Time difference of 0.621 secs
</code></pre>

<pre><code>## 
## Title:
##  GARCH Modelling 
## 
## Call:
##  garchFit(formula = ~garch(4, 1), data = y, include.mean = FALSE) 
## 
## Mean and Variance Equation:
##  data ~ garch(4, 1)
## &lt;environment: 0x0738642c&gt;
##  [data = y]
## 
## Conditional Distribution:
##  norm 
## 
## Coefficient(s):
##      omega      alpha1      alpha2      alpha3      alpha4       beta1  
## 0.02378770  0.00000001  0.01748996  0.05722037  0.06670140  0.84222003  
## 
## Std. Errors:
##  based on Hessian 
## 
## Error Analysis:
##         Estimate  Std. Error  t value Pr(&gt;|t|)    
## omega  2.379e-02   7.351e-03    3.236  0.00121 ** 
## alpha1 1.000e-08   1.899e-02    0.000  1.00000    
## alpha2 1.749e-02   3.321e-02    0.527  0.59840    
## alpha3 5.722e-02   3.738e-02    1.531  0.12585    
## alpha4 6.670e-02   3.626e-02    1.839  0.06586 .  
## beta1  8.422e-01   2.666e-02   31.589  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Log Likelihood:
##  -1826    normalized:  -1.451 
## 
## Description:
##  Sun Apr 28 20:41:11 2013 by user: Z-Q
</code></pre>

<pre><code class="r">garchFit(~garch(1, 1), data = y, include.mean = FALSE)
</code></pre>

<pre><code>## 
## Series Initialization:
##  ARMA Model:                arma
##  Formula Mean:              ~ arma(0, 0)
##  GARCH Model:               garch
##  Formula Variance:          ~ garch(1, 1)
##  ARMA Order:                0 0
##  Max ARMA Order:            0
##  GARCH Order:               1 1
##  Max GARCH Order:           1
##  Maximum Order:             1
##  Conditional Dist:          norm
##  h.start:                   2
##  llh.start:                 1
##  Length of Series:          1258
##  Recursion Init:            mci
##  Series Scale:              1.517
## 
## Parameter Initialization:
##  Initial Parameters:          $params
##  Limits of Transformations:   $U, $V
##  Which Parameters are Fixed?  $includes
##  Parameter Matrix:
##                     U         V params includes
##     mu     -2.045e-16 2.045e-16    0.0    FALSE
##     omega   1.000e-06 1.000e+02    0.1     TRUE
##     alpha1  1.000e-08 1.000e+00    0.1     TRUE
##     gamma1 -1.000e+00 1.000e+00    0.1    FALSE
##     beta1   1.000e-08 1.000e+00    0.8     TRUE
##     delta   0.000e+00 2.000e+00    2.0    FALSE
##     skew    1.000e-01 1.000e+01    1.0    FALSE
##     shape   1.000e+00 1.000e+01    4.0    FALSE
##  Index List of Parameters to be Optimized:
##  omega alpha1  beta1 
##      2      3      5 
##  Persistence:                  0.9 
## 
## 
## --- START OF TRACE ---
## Selected Algorithm: nlminb 
## 
## R coded nlminb Solver: 
## 
##   0:     1464.0419: 0.100000 0.100000 0.800000
##   1:     1408.6500: 0.0719156 0.100213 0.787311
##   2:     1371.3860: 0.0423929 0.108386 0.783937
##   3:     1326.9183: 0.0170660 0.159354 0.818348
##   4:     1326.5107: 0.0156579 0.159291 0.819245
##   5:     1325.5213: 0.0158487 0.159859 0.825903
##   6:     1323.3669: 0.0107953 0.152760 0.836042
##   7:     1320.9185: 0.0114416 0.145853 0.847471
##   8:     1317.8373: 0.00627024 0.128548 0.871830
##   9:     1315.7510: 0.00819318 0.105307 0.891214
##  10:     1313.4134: 0.00598171 0.0915625 0.896114
##  11:     1312.9120: 0.00688092 0.0806210 0.905978
##  12:     1312.4148: 0.00518630 0.0796297 0.911382
##  13:     1312.4071: 0.00528744 0.0796547 0.911406
##  14:     1312.4063: 0.00524914 0.0797544 0.911413
##  15:     1312.4050: 0.00529620 0.0799133 0.911278
##  16:     1312.4035: 0.00528258 0.0800567 0.911120
##  17:     1312.4009: 0.00533692 0.0804867 0.910677
##  18:     1312.3997: 0.00531799 0.0810074 0.910341
##  19:     1312.3995: 0.00537938 0.0813059 0.909801
##  20:     1312.3991: 0.00536138 0.0811762 0.910024
##  21:     1312.3991: 0.00536052 0.0811727 0.910029
##  22:     1312.3991: 0.00536061 0.0811730 0.910028
## 
## Final Estimate of the Negative LLH:
##  LLH:  1837    norm LLH:  1.46 
##   omega  alpha1   beta1 
## 0.01234 0.08117 0.91003 
## 
## R-optimhess Difference Approximated Hessian Matrix:
##          omega alpha1   beta1
## omega  -242329 -79509 -117673
## alpha1  -79509 -64620  -72787
## beta1  -117673 -72787  -94188
## attr(,&quot;time&quot;)
## Time difference of 0.037 secs
## 
## --- END OF TRACE ---
## 
## 
## Time to Estimate Parameters:
##  Time difference of 0.161 secs
</code></pre>

<pre><code>## 
## Title:
##  GARCH Modelling 
## 
## Call:
##  garchFit(formula = ~garch(1, 1), data = y, include.mean = FALSE) 
## 
## Mean and Variance Equation:
##  data ~ garch(1, 1)
## &lt;environment: 0x07382ecc&gt;
##  [data = y]
## 
## Conditional Distribution:
##  norm 
## 
## Coefficient(s):
##    omega    alpha1     beta1  
## 0.012341  0.081173  0.910028  
## 
## Std. Errors:
##  based on Hessian 
## 
## Error Analysis:
##         Estimate  Std. Error  t value Pr(&gt;|t|)    
## omega   0.012341    0.003542    3.484 0.000494 ***
## alpha1  0.081173    0.011952    6.791 1.11e-11 ***
## beta1   0.910028    0.012190   74.656  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Log Likelihood:
##  -1837    normalized:  -1.46 
## 
## Description:
##  Sun Apr 28 20:41:12 2013 by user: Z-Q
</code></pre>

<pre><code class="r">garchFit(~garch(1, 1), data = y, include.mean = FALSE, cond.dist = &quot;std&quot;, trace = F)
</code></pre>

<pre><code>## 
## Title:
##  GARCH Modelling 
## 
## Call:
##  garchFit(formula = ~garch(1, 1), data = y, cond.dist = &quot;std&quot;, 
##     include.mean = FALSE, trace = F) 
## 
## Mean and Variance Equation:
##  data ~ garch(1, 1)
## &lt;environment: 0x07429790&gt;
##  [data = y]
## 
## Conditional Distribution:
##  std 
## 
## Coefficient(s):
##     omega     alpha1      beta1      shape  
## 0.0071921  0.0841405  0.9147936  6.8134599  
## 
## Std. Errors:
##  based on Hessian 
## 
## Error Analysis:
##         Estimate  Std. Error  t value Pr(&gt;|t|)    
## omega   0.007192    0.003714    1.936   0.0528 .  
## alpha1  0.084140    0.014820    5.677 1.37e-08 ***
## beta1   0.914794    0.013652   67.006  &lt; 2e-16 ***
## shape   6.813460    1.376231    4.951 7.39e-07 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Log Likelihood:
##  -1813    normalized:  -1.441 
## 
## Description:
##  Sun Apr 28 20:41:12 2013 by user: Z-Q
</code></pre>

<pre><code class="r">res = garchFit(~garch(1, 1), data = y, include.mean = FALSE, cond.dist = &quot;sstd&quot;, 
    trace = F)  # saves output to res
plot(res)  # shows various graphical analysis
</code></pre>

<pre><code>## Error: menu() cannot be used non-interactively
</code></pre>

<h1>5风险预测实施</h1>

<p>包含VaR和ES两个风险变预测手段，又分为非参数与参数估计的两种方法</p>

<h2>5.1应用</h2>

<p>HS&ndash;历史模拟
第\( p*T \)个顺序观测值就是我们所需要的预测风险值，\( p*T \)需要时整数，则实际操作的时候需要将样本量进行删除。</p>

<h2>5.2历史模拟</h2>

<h3>5.2.1预期缺口估计（ES）</h3>

<p>比-VaR值小的值的平均值</p>

<h3>5.2.2\( W_E \)(window size)</h3>

<p>大\( W_E \)的优缺点：</p>

<ul>
<li>优点：VaR对个别极端值不敏感</li>
<li>缺点：旧数据对当前市场不具代表性</li>
</ul>

<pre><code class="r">library(&quot;tseries&quot;)  # time series library
# the two prices are downloaded separately
library(zoo)
p1 = get.hist.quote(instrument = &quot;msft&quot;, start = &quot;2000-01-01&quot;, end = &quot;2009-12-31&quot;, 
    quote = &quot;AdjClose&quot;)
</code></pre>

<pre><code>## time series starts 2000-01-03
</code></pre>

<pre><code class="r">p2 = get.hist.quote(instrument = &quot;ibm&quot;, start = &quot;2000-01-01&quot;, end = &quot;2009-12-31&quot;, 
    quote = &quot;AdjClose&quot;)
</code></pre>

<pre><code>## time series starts 2000-01-03
</code></pre>

<pre><code class="r">y1 = coredata(diff(log(p1)))  # convert prices to returns
y2 = coredata(diff(log(p2)))
y1 = tail(y1, T - 14)  # length adjustment
y2 = tail(y2, T - 14)
T = length(y1)
value = 1000  # portfolio value
y = cbind(y1, y2)  # combine returns in one matrix
p = 0.01  # probability
ys = sort(y1)  # sort returns
op = T * p  # p % smallest
VaR1 = -ys[op] * value  # VaR number
</code></pre>

<pre><code class="r">w = matrix(c(0.3, 0.7))  # vector of portfolio weights
yp = y %*% w  # obtain portfolio returns
yps = sort(yp)
VaR2 = -yps[op] * value  # VaR number
</code></pre>

<p>收益率是正态分布时候的VaR
单变量</p>

<pre><code class="r">sigma = sd(y1)  # estimate the volatility
VaR3 = -sigma * qnorm(p) * value  # calculate the VaR
</code></pre>

<p>多变量</p>

<pre><code class="r">sigma1 = sqrt(t(w) %*% cov(y) %*% w)  # portfolio volatility
VaR4 = -sigma1 * qnorm(p) * value
</code></pre>

<p>收益率是t分布时候的VaR</p>

<pre><code class="r">library(QRM)
</code></pre>

<pre><code>## Loading required package: gsl
</code></pre>

<pre><code>## Loading required package: Matrix
</code></pre>

<pre><code>## Loading required package: lattice
</code></pre>

<pre><code>## Loading required package: mvtnorm
</code></pre>

<pre><code>## Loading required package: numDeriv
</code></pre>

<pre><code>## Attaching package: &#39;QRM&#39;
</code></pre>

<pre><code>## The following object is masked from &#39;package:base&#39;:
## 
## lbeta
</code></pre>

<pre><code class="r">scy1 = (y1) * 100  # scale the returns
res = fit.st(scy1)  # estimate the distribution parameters
sigma = res$par.ests[3]/100  # rescale the volatility
nu = res$par.ests[1]  # extract the degrees of freedom
VaR5 = -sigma * qt(df = nu, p = p) * value  # calculates the VaR
</code></pre>

<p>5.3.4 正态分布下的ES</p>

<pre><code class="r">ES2 = sigma * dnorm(qnorm(p))/p * value
</code></pre>

<pre><code class="r">VaR = -qnorm(p)
integrand = function(q) {
    q * dnorm(q)
}
ES = -sigma * integrate(integrand, -Inf, -VaR)$value/p * value
</code></pre>

<h1>6期权和债券的VaR的分析</h1>

<p>在第五章里讲的VaR分析是针对资产的VaR分析，这是只要知道资产的分布是什么就可以了，但是这个资产是不包括期权和债券的，因为他们本质的价值随时间的变化而改变。</p>

<h2>6.1债券</h2>

<p>债券的价格计算公式如下：
\[ P=g\left(r,t \right)=\sum_{1}^{T}\frac{\tau _t}{{(1+r)}^{t}} \]
r与P不是呈线性变化的</p>

<h3>6.1.1</h3>

<p>债券价格的变化随时间的变化可以表示如下式
\[ g(r+dr)=g(r)+dr*g'(r) \]
修正的duration这么定义：\( {D}^{*}=-\frac{1}{P}g'(r) \)
计算债券的VaR的第一步就是辨别利率变化的分布函数\( r_t-r_{t-1}=dr\sim N(0,{\sigma _r}^{2}) \)</p>

<pre><code class="r">source(&quot;bs.r&quot;)  # input the Black Scholes pricing function
</code></pre>

<pre><code>## Warning: cannot open file &#39;bs.r&#39;: No such file or directory
</code></pre>

<pre><code>## Error: cannot open the connection
</code></pre>

<pre><code class="r">P0 = 50  # initial spot price
sigma = 0.2  # annual volatility
r = 0.05  # annual interest
T = 0.5  # time to expiration
X = 40  # strike price
f = bs(X, P0, r, sigma, T)  # analytical call price
</code></pre>

<pre><code>## Error: could not find function &quot;bs&quot;
</code></pre>

<pre><code class="r">
S = 1e+06  # number of simulations
set.seed(12)  # set seed
F = P0 * exp(r * T)  # futures price
ysim = rnorm(S, -0.5 * sigma * sigma * T, sigma * sqrt(T))  # simulated returns with the log normal correction
F = F * exp(ysim)  # futures price
SP = F - X  # payoff
SP[SP &lt; 0] = 0  # set negative outcomes to zero
fsim = SP * exp(-r * T)  # discount

hist(F, probability = TRUE, ylim = c(0, 0.06))  # make Figure 7.5
# make Figure 7.6
x = seq(min(F), max(F), length = 100)
lines(x, dnorm(x, mean = mean(F), sd = sd(SP)))
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAAflBMVEX9/v0AAAAAADkAAGUAOTkAOY8AZo8AZrU5AAA5ADk5AGU5OWU5OY85ZrU5j9plAABlADllAGVlOQBlOY9lZjlltf2POQCPOTmPOWWPZgCPtY+P29qP2/21ZgC1/rW1/v3ajzna24/a/rXa/tra/v39tWX924/9/rX9/tr9/v1dGX2NAAAAKnRSTlP//////////////////////////////////////////////////////wAyqPBcAAAACXBIWXMAAAsSAAALEgHS3X78AAAOe0lEQVR4nO2dDXejuBlGV8mmyW6nzmzbZNpuvHG38df//4MFjPNhSyCMMHr13HvmnBiBXzRcBJIM0k97kOSnuTMA84B4URAvCuJFQbwoiBcF8aIgXhTEi4J4URAvCuJFQbwoiBcF8aIgXhTEi4J4URAvCuJFQbwoiBcF8aIgXhTEi1Kq+O3j7et+v3u+fT18OrJ8GhF08+BuXvZ1WNcwJtbclC/+S/JylKzjtxGfLyclviqr7va1EXa/36+qP4t9I/D2j8e7t93zzT+rsryukqsSvXZ/qdJfVx9iD9s3375723vOJ4NoiN8+1gX07n8H8cumuN4fTP78UIuv1/552Oht7Y60etvtEW+Bg+raXS1+89AIO1ysNw9Vsd4+3rxsHip/K9eIvz9+7fZ17eovuKd6kzrtffvTS/39PP+1NGiIb5bqUlqrWzfGVu6p+bA9XOpfjl+qxd83J8Ax9X17xBvAc493bZkNiW+2eRf/cTr4xHOpzxVPc27ZqvNd6mvFq6oCVyedivdd6hGfK1/FHwtzXU/zVu5qxWvnL/Hv2yPeAJ5LfXs5r6p5x+ZcdU8/NudqxZXgRXsH+CL+fXvEF8TatRV+MZTFtzX/xdz5mAVl8Ye7uulG2eVIi1cG8aIgXhTEi4J4URAvCuJFQbwoiBcF8aIgXhTEi4J4URAvCuJFQbwoiBcF8aIgXhTEi4J4URAvSr/4zcNT/a6R5msH5dIrfvf81Awcs/mG+ZLoFb/97XX346X5e438wJXov9RXxX292O/Xom+clEpE5W5pf/gHOINavSiIFyWmOfd56C8ohKjmXM2ahnxRxDTnvvyFMqDEi9J/j28HDPl0j38f8nPKjMG0jKnVI94w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" alt="plot of chunk unnamed-chunk-11"/> </p>

<pre><code class="r">hist(fsim, nclass = 100, probability = TRUE)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAAflBMVEX9/v0AAAAAADkAAGUAOTkAOY8AZo8AZrU5AAA5ADk5AGU5OWU5OY85j9plAABlADllAGVlOQBlOY9lZjlltf2POQCPOTmPOWWPZgCPj2WPtY+P29qP2/21ZgC1/rW1/v3ajzna24/a/rXa/tra/v39tWX924/9/rX9/tr9/v3P5AqEAAAAKnRSTlP//////////////////////////////////////////////////////wAyqPBcAAAACXBIWXMAAAsSAAALEgHS3X78AAAMN0lEQVR4nO3dC1fjxgFA4YgNhaZrNknx9mUHN8UP/f8/WD0sWEDG0kiyNXPvPZwDSzy2w8fohS39lBuyn679BOw6CQ9NeGjCQxMemvDQhIcmPDThoQkPTXhowkMTHprw0ISHJjw04aEJD014aMJDEx6a8NCEhyY8NOGhpQW/f/jylOeH5Zen+qum9eOAO93dZzerN1+8PFLEpQr/5tvrbAj8y+hhdzOzUoWvviqmaPbl6bDMsuwuzzfFp0Ve/ufsyx8Pt8+H5c3fiym8Lb5dTORt9pfi+0/FjRrd+vbV6NvnvPmivs/qkT4OiaiU4fcPWWn1vxp+Xf6j+FwB/nxfwpf/9c/6Rs/brOm4uDje/h18c/Ma/t2QmEoNvoEoYXb3JVheL6N398W03j/crHb3BdMmq+DvmmGlYjkgeyxvUn7v5fZvF/XNfbYNiaqU4at/lZOxFNtWypvssfpiXy/qV82gUvGu0my++3L7t/DNfdbwb4dEVWrwH9bx2XHOnoKvbvMC//rrcAK+uc9X+NchUZU0fNn6SNe2qC+9NsUGXPmt94onFvXNF8LPqrfwzWQut9NaN+5Kr23WPuNfbv9+Hf+6KhF+NrUs6o+L82KTrNmdK1bTze5c6VUAL45rgLeKze0/LuqrZYHwMbbNjhv82Hjwxy3/xbWfx5Xjwddr9btrP4trB4S3MuGhCQ9NeGjCQxMemvDQhIcmPDThoQkPTXhowkMTHprw0ISHJjw04aEJD014aMJDEx6a8NCEhyY8NOGhCQ9NeGjCQxMemvDQhIcmPLQR4csTTYx3bzZtY8JXHxZHwkMTHprw0ISHJjw04aEJD014aMJDEx6a8NCEhyY8NOGhCQ9NeGjCQxMemvDQhIcmPDThoQkPTXho5+HrK6aXl2E/k/AxdRb+sKyvnr49e91t4WPqLPz+16c3n08nfEw546GdX8fvH1zHJ5hb9dCEhyY8NOGhnd+dq7ftOmzdCR9T52f8YbnodlfCx1SHRf3+2+rtN7Kmd98WPqKGrOOFjzjhoXWGbzlWL3zEOeOhCQ9tyAsxhI+4IX+WFT7ihrwQQ/iIc8ZDG/JCDOEjzq16aMJDEx6a8NCEhyY8NOGhCQ9NeGjCQxMemvDQhIcmPDThoQkPTXhowkMTHprw0ISHJjw04aEJD014aMJDEx6a8NCEhyY8NOGhCQ9NeGjCQxMemvDQhIcmPDThoXU6l+3dxvPcpdb5M1t+X+Wbu8L/q2e2TKlO57LdLDyXbWo546F1WscvXMcnl1v10ISH5qVJoHmhAmhemgSaMx5ayKVJvKhwArlVD014aF5UGJozHprw0DxyB839eGgeuYPmjIfmRYWhuVUPTXhowkMTHprw0ISHJjw04aEJD014aMJDEx6a8NCEhyY8NOGhCQ9NeGjCQxMemvDQhIcmPDThoQkPTXhowkMTHprw0ISHJjw04aEJD014aMJDEx6a8NCEhyY8NOGhdTmJ8eNhmWUfT2wpfMx1OqXp+tFry6ZWl5MYl9cV9iTGiXV+UV9M9+0iz7d3H/6L8BFXw+8fPrK+tK5OYtxyA+Ejrpnx2yy7WfUcK3zE/bCoL7fdH/uMFT7iGvjdfTnjW7bgvCZNmjXr+Jbd9DqvUJFmR/hqprfNd69Jk2gl/PHiI61H55zxifbjjG/Pq0knmX+kgVYt6n/94+SVpj5L+IjzatLQXNRDO8Jvbp83PY/bCR91x636b6viY/dL2zreI3dJ9rI7V8z5Vnj349OsWdRnN6tt66J+2iN3rQcE7AJd+WrS2cuH/JftyleT/lFd+Et2hN9e4wDOi/crv/P+UjV/lu25J1c1GP7Eh12g83+kOZ3wEXdc1K8XAWOFj7hmUX/xdfz7Fbzwl+1qx+pPqbt9d5nmB++kv0hH+MMyu/3zW88X1gsfcTX8YbnYfX1uOTj3aeHwn6zgXdpfppfduQK+707dAPgOHzZpP874zeVmvPDX7nUd3/7q6s8SPuKusFV/ZgUv/EW6BrwzfgbV8NXLq3oet5sW3g37iavgt9Vb43f307/YMuu4nHfST10JX53jJm89v9GnhcDnndWFn7T6nTQnX1b3acJHnPDQZgzv9t2UvXl//PR/j+8344Wfrgvvxws/l4SHJjy0S8IfN9d6wLt9N1kXhQ+Y8cJPlPDQhIcmPDThoV0M/vWt0P3g3bCfpsvBB8944adIeGjCQxMeWgzwbt9NUAzwTvoJEh6a8NA6wree7bQ7/I+vphd+Fp2/tuzpF+T1gHfGz60uZ7YsyIfOeOHnVpdF/f7h9r/CJ1a3dfzuvu2V18JH3GW26gfDewxn7CKBd9KP3Xn4wZcmeffOaOFn0QUuVPCeT/g5dH4/fvClSYSfY854aCGXJul5UeGR4N2wH7ULbNWPNuOFHzHhoU19UeGPZ7kSfhZNPeNb7ISfQ8JDm/rInfAzber9eOFn2tRH7kaFd1d+vCKb8cKP1dQXFRZ+pkW2VS/8WAkPbVL41pPTCz+LpoUff8a7ZT9SscF/fFgLSnhowkMTHprw0ISHFiO8e3QjNB38qUsLjjHjhR/chPATLuqFH5zw0ISHJjw04aEJDy1SeHflhxYpvJN+aMJDmwj+1GE74efSVPDTz3hX84OKF95JPyjhoQkPTXhowkMTHprw0KaA/+TojfBzaRL4S814j+GEFzW8kz484aHFDu/SPrDY4Z30gQkPTXhoo8N/vhMv/FwaH94ZH0WdTmJ8s+p+SlPh46jTKU0Py4XwidXxJMbru/nCuysfUteTGG9+/ng96ZnAO+lD6nIS40X5afPxLMbCR1wSW/XC9094aCNfk+bc0Rvh59LoV6i4Crwb9r0b/Zo0V5rxwvcsjRkvfO9Gv5q08HGUyla9q/meJQPvpO/X6FeTFj6OnPHQhIc2+tWkhY+jhPbj3bDvU0JH7pz0fUppxgvfo9GvJi18HKW1VS985xKDd/uua4nBO+m7Jjw04aGlB+9qvlPpwTvpOyU8NOGhJQnvav58ScI76c8nPDThoaUK72r+TKnCO+nPJDy0hOFd2n9WwvBO+s8SHprw0NKGdzV/srThnfQnEx5a8vAu7dtLHt5J3x4B3knfEgHeSd+S8NCEhwaBdzX/Pgi89u/jwH94vuyEh4aCd2n/Ggq+the/jAb/8WlDEx4aEd6lfc6Ed9LnqZ3LtvP4titssEruzJb9xnNL7ly2fcaTJz18xnPtkzuXbf/xTHvsVj3dXvhXexQ/dHdOfvrGHZYfvTvXhT/V3wBnfI/fgJR+Eca8qLBdt5HhLcmEhzbkosIWcc54aMJDG3LkziJuyH68RdyQI3cWcc54aENeiGER51Y9NOGhCQ9tRPhr/mEK2ECtMeEdHMvgXHjm4Fx45uBceObgXHjm4Fx45uBceObg3AM42ISHJjw04aEJD014aMJDEx6a8NCEhzYW/P4hC3799e6Xp9A7KN/m8xg6eFu/djj0qVcvPA8bvMmqhw4bfFhmN6thP/F8NPjyh7C5Cxu7LX8GYXew/7bKd39dhQ0uf9+KUcFPfVP8ygUOXlfvVQgfvL19HvITLxsJvnyfTTVx+7e++XcxMOwOtuX/+fox/NGLUaGDd3/77THwaR++r8pPYYOPb2ka8BOvGgl+9/W5mn5hg4vnH34HxajwwcWcCRx8+P6fYs6FDa7eoxI6ePf1n+WiftBPPB8NvnyD1SD44Ds4LBfBg3f3xU8wcPBmUS5swwYXa6dy1gcOvq9+ZQb9xPP4Z/z+YTHk0YMXF8WoQ/CMr1o/Bj/ysKVc3fXX8TV84B2Uv/7DtjACNxA21WvbF1d45P3vlfhM1vHlAjd4G7N8/mF3ULsHDj4uLIOfejnjwx/58I+nwEdeP9bLmwE/8Tz2/fh63j2G700P2SEeth8f/sjFqCGHH4555A6a8NCEhyY8NOGhCQ9NeGjCQxMemvDQhIcmPDThoQkPTXhowkMTHprw0ISHJjw0OPxhmS3qr4a8VDnG4PA07tfY8PuH7GZVv1u6+BU4fP9Xli2Kfy6u/bwuEBu+ebds+d7JAn5ZfLq/YywGhD++Aa2a8dV7GQe9JS2ahC/PqlG+7Vh4Usel+vb2WXhUBXf5DkbhaZUzfv26VS+8pZ7w0ISHJjw04aEJD014aMJDEx6a8NCEhyY8NOGhCQ9NeGjCQxMemvDQ/g8Z9Vrjv0QMjAAAAABJRU5ErkJggg==" alt="plot of chunk unnamed-chunk-11"/> </p>

<h3>7.3.1</h3>

<p>VaR值的MC模拟步骤
1. 计算投资组合的初始价值
\[ \vartheta _{t}=x^{b}P_{t} \]
2. 从正太分布中模拟S个一天收益率\( y_{t+1,i} \)
\[ N\left ( 0,\sigma ^{2} \right ),i=1,2...S \]
3. 计算一天后的远期价格
\[ P_{t+1,i}=P_te^{r(1/365)}e^{y_{t+1,i}}e^{-0.5\sigma ^2} \]
4. 计算投资组合模拟的远期价值
\[ q_{t+1,i}=x^{b}P_{t+1,i} \]
5. 模拟出来的第i个的利/亏值
\[ q_{t+1,i}=\vartheta _{t+1,i}-\vartheta _{t} \]
6. VaR可以直接从模拟出来的P/L数组里得到</p>

<pre><code class="r">set.seed(1)  # set seed
S = 1e+07  # number of simulations
s2 = 0.01^2  # daily variance
p = 0.01  # probability
r = 0.05  # annual risk free
P = 100  # today’s price
ysim = rnorm(S, r/365 - 0.5 * s2, sqrt(s2))  # sim returns
Psim = P * exp(ysim)  # future prices
q = sort(Psim - P)  # simulated P/L
VaR1 = -q[p * S]  # get VaR
</code></pre>

<h3>7.3.2</h3>

<p>债券的模拟步骤只要将第一与第四步替换成如下
1&#39;. \[ \vartheta _{t}=x^{0}g(P_{t},X,T,\sqrt{250}\sigma ,r) \]
4&#39;. \[ \vartheta _{t+1,i}=x^{0}g(P_{t+1,i},X,T-1/365,\sqrt{250}\sigma ,r) \]</p>

<pre><code class="r">T = 0.25; # time to expiration
X = 100; # strike price
sigma = sqrt(s2 * 250); # annual volatility
source(&#39;bs.r&#39;)
</code></pre>

<pre><code>## Warning: cannot open file &#39;bs.r&#39;: No such file or directory
</code></pre>

<pre><code>## Error: cannot open the connection
</code></pre>

<pre><code class="r">f=bs(X,P,r,sigma,T) # analytical call price
</code></pre>

<pre><code>## Error: could not find function &quot;bs&quot;
</code></pre>

<pre><code class="r">fsim = bs(X,Psim,r,sigma,T- (1/365)) # simulate option prices
</code></pre>

<pre><code>## Error: could not find function &quot;bs&quot;
</code></pre>

<pre><code class="r">q=sort(fsim$Call - f$Call) # simulated P/L
</code></pre>

<pre><code>## Error: error in evaluating the argument &#39;x&#39; in selecting a method for
## function &#39;sort&#39;: Error in fsim$Call : $ operator is invalid for atomic
## vectors
</code></pre>

<pre><code class="r">VaR2 = -q[p * S] # get VaR
</code></pre>

<h3>7.3.3</h3>

<p>债券与股票的组合模拟就是将第一步与第四部分别的式子进行简单的相加</p>

<h2>7.4投资组合VaR的模拟</h2>

<h2>8.2 S&amp;P500的后验检验</h2>

<pre><code class="r">library(&quot;tseries&quot;) # time series library
library(zoo)
p=get.hist.quote(instrument = &quot;^gspc&quot;, start = &quot;1994-02-11&quot;,end = &quot;2009-12-31&quot;,quote = &quot;AdjClose&quot;,quiet = T)# download the prices
y=diff(log (p)) # get returns
y=coredata (y) # strip date information from returns
T=length (y) # number of observations for return y
WE = 1000 # estimation window length
p = 0.01 # probability
l1 = WE * p # HS observation
value = 1; # portfolio
VaR = matrix (nrow=T,ncol=4) # matrix to hold VaR forecasts for 4 models
# EWMA setup
lambda = 0.94;
s11 = var (y[1:30]);
for (t in 2:WE) s11 = lambda * s11 + (1 - lambda) * y[t - 1]^2
library(fGarch)
for (t in (WE + 1):T){
t1 = t- WE; # start of the data window
t2 = t- 1; # end of the data window
window = y[t1:t2] # data for estimation
# EWMA
s11 = lambda * s11 + (1- lambda) * y[t - 1]^2
VaR[t,1] = -qnorm(p) * sqrt(s11) * value#没有-号
#MA
VaR[t,2] = -sd(window) * qnorm(p)* value#没有-号
#HS
ys =sort(window) # sort returns
VaR[t,3] = -ys[l1]* value # VaR number
# GARCH(1,1)
g=garchFit (formula = ~ garch(1,1), window ,trace=FALSE,include.mean=FALSE)
par=g@fit$matcoef # put parameters into vector par
s4=par[1]+par[2]* window[WE]^2+par[3]* g@h.t[WE]
VaR[t,4] =- sqrt(s4) * qnorm(p) * value   #没有-号，教材错误
}

W1 = WE+1
for (i in 1:4){
VR =sum (y[W1:T] &lt; - VaR[W1:T,i])/(p*(T - WE))
s=sd(VaR[W1:T,i]) # VaR volatility
cat (i,&quot;VR&quot;,VR,&quot;VaR vol&quot;,s,&quot;\n&quot;) # print results
}
</code></pre>

<pre><code>## 1 VR 1.867 VaR vol 0.01565 
## 2 VR 3.033 VaR vol 0.005965 
## 3 VR 2.033 VaR vol 0.008924 
## 4 VR 1.833 VaR vol 0.01464
</code></pre>

<pre><code class="r">matplot(cbind(y[W1:T],VaR[W1:T,]),type=&#39;l&#39;)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-14"/> </p>

<h3>8.3.1 伯努利覆盖检验</h3>

<pre><code class="r">bern_test = function(p, v) {
    a = p^(sum(v)) * (1 - p)^(length(v) - sum(v))
    b = (sum(v)/length(v))^(sum(v)) * (1 - (sum(v)/length(v)))^(length(v) - 
        sum(v))
    return(-2 * log(a/b))
}
</code></pre>

<h3>8.3.2 violations的独立性检验</h3>

<pre><code class="r">ind_test = function(V) {
    J = matrix(ncol = 4, nrow = length(V))
    for (i in 2:length(V)) {
        J[i, 1] = V[i - 1] == 0 &amp; V[i] == 0
        J[i, 2] = V[i - 1] == 0 &amp; V[i] == 1
        J[i, 3] = V[i - 1] == 1 &amp; V[i] == 0
        J[i, 4] = V[i - 1] == 1 &amp; V[i] == 1
    }
    V_00 = sum(J[, 1], na.rm = TRUE)
    V_01 = sum(J[, 2], na.rm = TRUE)
    V_10 = sum(J[, 3], na.rm = TRUE)
    V_11 = sum(J[, 4], na.rm = TRUE)
    p_00 = V_00/(V_00 + V_01)
    p_01 = V_01/(V_00 + V_01)
    p_10 = V_10/(V_10 + V_11)
    p_11 = V_11/(V_10 + V_11)
    hat_p = (V_01 + V_11)/(V_00 + V_01 + V_10 + V_11)
    a = (1 - hat_p)^(V_00 + V_10) * (hat_p)^(V_01 + V_11)
    b = (p_00)^(V_00) * (p_01)^(V_01) * (p_10)^(V_10) * p_11^(V_11)
    return(-2 * log(a/b))
}
</code></pre>

<h4>8.3.3 S&amp;P的VaR的检验</h4>

<pre><code class="r">W1 = WE + 1
ya = y[W1:T]
VaRa = VaR[W1:T, ]
m = c(&quot;EWMA&quot;, &quot;MA&quot;, &quot;HS&quot;, &quot;GARCH&quot;)
for (i in 1:4) {
    q = y[W1:T] &lt; -VaR[W1:T, i]
    v = VaRa * 0
    v[q, i] = 1
    ber = bern_test(p, v[, i])
    ind = ind_test(v[, i])
    cat(i, m[i], &quot;Bernoulli&quot;, ber, 1 - pchisq(ber, 1), &quot;independence&quot;, ind, 
        1 - pchisq(ind, 1), &quot;\n&quot;)
}
</code></pre>

<pre><code>## 1 EWMA Bernoulli 18.13 2.059e-05 independence 0.002102 0.9634 
## 2 MA Bernoulli 81.22 0 independence 7.187 0.007343 
## 3 HS Bernoulli 24.91 6.022e-07 independence 4.108 0.04269 
## 4 GARCH Bernoulli 16.89 3.969e-05 independence 7.754e-05 0.993
</code></pre>

<h2>8.4 期望缺口的后验检验</h2>

<pre><code class="r">ES = matrix(nrow = T, ncol = 2)  # ES forecasts for 2 models
VaR = matrix(nrow = T, ncol = 2)  # VaR forecasts for 2 models
for (t in (WE + 1):T) {
    t1 = t - WE
    t2 = t - 1
    window = y[t1:t2]
    # EWMA
    s11 = lambda * s11 + (1 - lambda) * y[t - 1]^2
    VaR[t, 1] = -qnorm(p) * sqrt(s11) * value
    ES[t, 1] = sqrt(s11) * dnorm(qnorm(p))/p
    # HS
    ys = sort(window)
    VaR[t, 2] = -ys[l1] * value
    ES[t, 2] = -mean(ys[1:l1]) * value  # ES number
}

ESa = ES[W1:T, ]
VaRa = VaR[W1:T, ]
for (i in 1:2) {
    q = ya &lt;= -VaRa[, i]
    nES = mean(ya[q]/-ESa[q, i])
    cat(i, &quot;nES&quot;, nES, &quot;\n&quot;)
}
</code></pre>

<pre><code>## 1 nES 1.111 
## 2 nES 1.084
</code></pre>

</body>

</html>

